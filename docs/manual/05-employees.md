# 5. 従業員管理

## 5.1 概要

従業員管理機能では、組織内の従業員情報を一元管理できます。一覧画面での従業員情報の閲覧、詳細情報の確認、そして管理者権限を持つユーザーは従業員の新規登録・編集・削除を行うことができます。

### 主な機能

- **従業員一覧**: すべての従業員情報を一覧表示
- **従業員詳細**: 個別の従業員の詳細情報を表示
- **従業員登録**: 新しい従業員の追加（管理者のみ）
- **従業員編集**: 既存の従業員情報の更新（管理者のみ）
- **閲覧**: すべてのユーザーが従業員情報を閲覧可能

### ユーザー権限による機能制限

| 機能 | 一般ユーザー | 管理者 |
|------|------------|--------|
| 従業員一覧の閲覧 | ✓ | ✓ |
| 従業員詳細の閲覧 | ✓ | ✓ |
| 従業員の新規登録 | ✗ | ✓ |
| 従業員情報の編集 | ✗ | ✓ |
| 従業員の削除 | ✗ | ✓ |

> **重要**: 従業員の新規登録・編集・削除は管理者（Adminロール）のみが実行できます。一般ユーザーは閲覧のみ可能です。

## 5.2 従業員一覧画面

### アクセス方法

従業員一覧画面には、以下の方法でアクセスできます：

1. トップページのナビゲーションメニューから「従業員一覧」をクリック
2. ブラウザのアドレスバーに `/employees` と入力

### 画面構成

従業員一覧画面は以下の要素で構成されています：

#### ヘッダー部分

- **ページタイトル**: 「従業員一覧」
- **従業員を追加ボタン**: 管理者の場合のみ表示される＋アイコンのボタン
- **ログイン状態表示**: ログイン中のユーザー名を表示するチップ

#### 一覧テーブル

従業員情報が表形式で表示されます：

| 列名 | 説明 |
|------|------|
| ID | 従業員のユニークID（最初の8文字のみ表示） |
| 氏名 | 従業員のフルネーム（姓名） |
| メールアドレス | 連絡用メールアドレス |
| 部署 | 所属部署名 |
| 役職 | 役職名 |
| 入社日 | 入社日（yyyy/MM/dd形式） |
| アクション/詳細 | 操作ボタン（権限により表示が異なる） |

#### フッター部分

- **合計件数**: 登録されている従業員の総数が表示されます

### 管理者と一般ユーザーの表示の違い

#### 管理者の場合

- ヘッダーに「従業員を追加」ボタンが表示されます
- アクション列に「編集」と「詳細」ボタンが表示されます
- 従業員の追加、編集が可能です

#### 一般ユーザーの場合

- 「従業員を追加」ボタンは表示されません
- 詳細列に「詳細」ボタンのみが表示されます
- 従業員情報の閲覧のみが可能です

### 初回アクセス時の注意

ログインしていない状態でもアクセスは可能ですが、ログインを推奨する警告メッセージが表示されます：

> ⚠️ この機能を利用するには[ログイン]することをお勧めします。

## 5.3 従業員の検索・絞り込み

> **現在の状態**: 検索・絞り込み機能は実装予定です。現在はすべての従業員が一覧表示されます。

将来的には以下の機能が追加される予定です：

- 氏名による検索
- 部署による絞り込み
- 役職による絞り込み
- 入社日の範囲指定

## 5.4 従業員の新規登録（管理者のみ）

### 登録手順

1. 従業員一覧画面右上の「従業員を追加」ボタン（＋アイコン）をクリック
2. 従業員登録ダイアログが表示されます
3. 必要な情報を入力します：
   - **名**: 従業員の名（必須）
   - **姓**: 従業員の姓（必須）
   - **メールアドレス**: 連絡用のメールアドレス（必須、メール形式）
   - **部署**: 所属部署名（必須）
   - **役職**: 役職名（必須）
   - **入社日**: 入社日（必須、カレンダーから選択）
4. すべての必須項目を入力後、「保存」ボタンをクリック
5. 登録が成功すると、成功メッセージが表示され、一覧画面が更新されます

### 入力時の注意点

- **すべての項目が必須**: 空欄のまま保存することはできません
- **メールアドレス形式**: 有効なメールアドレス形式（例: `tanaka@example.com`）で入力してください
- **入社日**: カレンダーアイコンをクリックして日付を選択できます

### 登録のキャンセル

入力中に登録をキャンセルする場合：

- ダイアログの「キャンセル」ボタンをクリック
- またはダイアログ右上の✗ボタンをクリック

入力内容は破棄され、一覧画面に戻ります。

### エラー処理

登録時にエラーが発生した場合、以下のようなメッセージが表示されます：

- **権限エラー**: 「この操作を実行する権限がありません」
- **入力エラー**: 「[項目名]を入力してください」
- **システムエラー**: 具体的なエラーメッセージが表示されます

## 5.5 従業員情報の編集（管理者のみ）

### 編集手順

1. 従業員一覧画面で編集したい従業員の行の「編集」ボタンをクリック
2. 従業員編集ダイアログが表示されます（現在の情報が入力された状態）
3. 変更したい項目を修正します：
   - 名
   - 姓
   - メールアドレス
   - 部署
   - 役職
   - 入社日
4. 「保存」ボタンをクリック
5. 更新が成功すると、成功メッセージが表示され、一覧画面が更新されます

### 編集時の注意点

- **従業員ID**: 変更できません（システムが管理）
- **作成日時・更新日時**: 自動的に更新されます
- すべての項目は新規登録時と同じバリデーションルールが適用されます

### 編集のキャンセル

編集中にキャンセルする場合：

- ダイアログの「キャンセル」ボタンをクリック
- またはダイアログ右上の✗ボタンをクリック

変更内容は破棄され、一覧画面に戻ります。

## 5.6 従業員の削除（管理者のみ）

> **現在の状態**: 削除機能は実装予定です。現在はUIから直接削除することはできません。

将来的には以下の機能が追加される予定です：

- 一覧画面または詳細画面から削除ボタンを表示
- 削除確認ダイアログの表示
- 論理削除またはソフトデリート機能

## 5.7 従業員詳細画面

### アクセス方法

従業員詳細画面には、以下の方法でアクセスできます：

1. 従業員一覧画面で「詳細」ボタンをクリック
2. ブラウザのアドレスバーに `/employees/{従業員ID}` と入力

### 画面構成

従業員詳細画面では、選択した従業員の詳細情報がカード形式で表示されます。

#### パンくずリスト

画面上部にパンくずリストが表示され、現在位置を確認できます：

```
ホーム > 従業員一覧 > 詳細
```

#### 表示項目

| 項目 | 説明 | 形式 |
|------|------|------|
| 従業員ID | システムが割り当てる一意のID | GUID形式 |
| 氏名 | フルネーム（姓名） | テキスト |
| 名 | 従業員の名 | テキスト |
| 姓 | 従業員の姓 | テキスト |
| メールアドレス | 連絡用メールアドレス | クリック可能なリンク |
| 入社日 | 入社日 | yyyy年MM月dd日形式 |
| 部署 | 所属部署名 | テキスト |
| 役職 | 役職名 | テキスト |
| 作成日時 | レコード作成日時 | yyyy/MM/dd HH:mm:ss形式 |
| 更新日時 | 最終更新日時 | yyyy/MM/dd HH:mm:ss形式 |

#### アクション

- **一覧に戻る**: 従業員一覧画面に戻ります

### メールアドレスのリンク

メールアドレスはクリック可能なリンクとして表示されます。クリックすると、デフォルトのメールクライアントが起動し、該当の従業員宛てにメールを作成できます。

## 5.8 一般ユーザーができる範囲

一般ユーザー（Userロール）は、従業員管理機能において以下の操作のみが可能です：

### ✓ 可能な操作

1. **従業員一覧の閲覧**
   - すべての従業員の基本情報を一覧で確認
   - 表形式で整理された情報の閲覧

2. **従業員詳細の閲覧**
   - 個別の従業員の詳細情報の確認
   - 連絡先情報（メールアドレス）の確認
   - 部署・役職・入社日などの情報の確認

3. **基本的なナビゲーション**
   - 一覧画面と詳細画面の行き来
   - パンくずリストを使った画面遷移

### ✗ 制限される操作

1. **従業員の新規登録**
   - 「従業員を追加」ボタンが表示されません
   - 新しい従業員を追加することはできません

2. **従業員情報の編集**
   - 「編集」ボタンが表示されません
   - 既存の従業員情報を変更することはできません

3. **従業員の削除**
   - 削除関連のボタンが表示されません
   - 従業員レコードを削除することはできません

### 権限不足時の動作

一般ユーザーが管理者専用の操作を試みた場合：

- UIレベルで該当するボタンやメニューが表示されません
- 万が一APIを直接呼び出そうとした場合は、`403 Forbidden` エラーが返されます
- エラーメッセージ「この操作を実行する権限がありません」が表示されます

## 5.9 トラブルシューティング

### よくある問題と解決方法

#### 従業員一覧が表示されない

**症状**: 一覧画面を開いても従業員データが表示されない

**原因と対処法**:
1. **データが未登録**: まだ従業員が登録されていない
   - 対処: 管理者アカウントでログインし、従業員を追加してください

2. **読み込みエラー**: データベース接続エラー
   - 対処: 画面に表示される「再試行」ボタンをクリックしてください
   - それでも解決しない場合は、システム管理者に連絡してください

#### 編集・追加ボタンが表示されない

**症状**: 管理者なのに「従業員を追加」や「編集」ボタンが表示されない

**原因と対処法**:
1. **権限が正しく設定されていない**: ユーザーアカウントにAdminロールが付与されていない
   - 対処: システム管理者にAdminロールの付与を依頼してください

2. **ログインしていない**: 未ログイン状態
   - 対処: ログイン画面からログインしてください

#### 保存時にエラーが発生する

**症状**: 従業員情報を保存しようとするとエラーメッセージが表示される

**原因と対処法**:
1. **必須項目の未入力**: すべての項目が入力されていない
   - 対処: 赤文字で表示されるエラーメッセージを確認し、該当項目を入力してください

2. **メールアドレス形式エラー**: 無効なメールアドレス形式
   - 対処: 正しいメールアドレス形式（例: `user@example.com`）で入力してください

3. **権限エラー**: 一般ユーザーが編集を試みた
   - 対処: 管理者アカウントでログインし直してください

## 5.10 ベストプラクティス

### 従業員情報の管理

1. **正確な情報の入力**
   - メールアドレスは現在使用中のものを登録してください
   - 部署名・役職名は組織の正式な名称を使用してください

2. **定期的な情報更新**
   - 異動や昇進があった場合は速やかに情報を更新してください
   - 退職者の情報も適切に管理してください

3. **セキュリティとプライバシー**
   - 従業員情報は機密情報として扱ってください
   - 必要のない第三者と情報を共有しないでください

### 管理者の責任

1. **データ品質の維持**
   - 重複登録を避けてください
   - 不正確な情報は速やかに修正してください

2. **権限管理**
   - 管理者権限は必要最小限のユーザーにのみ付与してください
   - 定期的に権限の見直しを行ってください

## 5.11 関連ドキュメント

従業員管理機能をより深く理解するために、以下のドキュメントも参照してください：

- **[Getting Started](../getting-started.md)**: システムのセットアップと起動方法
- **[認証・認可実装](../authorization-implementation.md)**: 権限管理の詳細な仕組み
- **[アーキテクチャ概要](../architecture.md)**: システム全体の構成
- **[開発ガイド](../development-guide.md)**: 機能拡張やカスタマイズ方法

## 5.12 今後の機能拡張予定

従業員管理機能は、今後以下の機能が追加される予定です：

- [ ] 検索機能（氏名、メールアドレス）
- [ ] 高度な絞り込み機能（部署、役職、入社日範囲）
- [ ] 一覧のソート機能（各列でソート可能）
- [ ] ページネーション（大量データへの対応）
- [ ] CSVエクスポート機能
- [ ] 一括インポート機能
- [ ] 従業員の削除機能（論理削除）
- [ ] 履歴管理機能（変更履歴の追跡）
- [ ] 写真アップロード機能

---

## まとめ

従業員管理機能は、組織の従業員情報を一元管理するための中核機能です。一般ユーザーは閲覧のみ、管理者は新規登録・編集を含むすべての操作が可能です。

- **＋ボタンで新規従業員追加**（管理者のみ）
- **一般ユーザーは閲覧のみで編集不可**
- シンプルで直感的なUIデザイン
- 権限に応じた適切な機能制限

質問やフィードバックがある場合は、本システムのGitHubリポジトリのIssueでお知らせください。
